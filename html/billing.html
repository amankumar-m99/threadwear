<!doctype html>
<html lang="en">

<head>
   <!-- Required meta tags -->
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">

   <!-- favicon -->
   <link rel="shortcut icon" href="../images/logo/favicon.png" type="image/x-icon">

   <!-- bootstrap-icons -->
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

   <!-- Bootstrap CSS -->
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

   <!-- jquery -->
   <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
      crossorigin="anonymous">
      </script>
   <title>Order checkout | Thread Wear</title>
</head>

<body>
   <main>
      <div class="container">
         <div class="py-5 text-center">
            <img class="d-block mx-auto mb-4" src="../images/logo/logo.png" alt="" width="90">
            <h2>Checkout your order <i class="bi bi-cart-check"></i></h2>
         </div>

         <div class="row g-5">
            <!-- cart items details -->
            <div class="col-md-5 col-lg-4 order-md-last">
               <h4 class="d-flex justify-content-between align-items-center mb-3">
                  <span class="text-primary">Your cart</span>
                  <!-- <span class="badge bg-primary rounded-pill">3</span> -->
               </h4>
               <ul class="list-group mb-3">
                  <li class="list-group-item d-flex justify-content-between lh-sm">
                     <div>
                        <h6 class="my-0">Product name</h6>
                        <small class="text-muted" id="product-description"></small>
                     </div>
                     <span class="text-muted" id="product-name"></span>
                  </li>
                  <li class="list-group-item d-flex justify-content-between lh-sm">
                     <div>
                        <h6 class="my-0">Product ID</h6>
                        <small class="text-muted"></small>
                     </div>
                     <span class="text-muted" id="product-id"></span>
                  </li>
                  <li class="list-group-item d-flex justify-content-between lh-sm">
                     <div>
                        <h6 class="my-0">Product Price</h6>
                        <small class="text-muted">MRP in INR</small>
                     </div>
                     <span class="text-muted" id="product-price"></span>
                  </li>
                  <li class="list-group-item d-flex justify-content-between bg-light">
                     <div class="text-success">
                        <h6 class="my-0">Discount</h6>
                        <small id="discount-percentage"></small>
                     </div>
                     <span class="text-success" id="discount-amount"></span>
                  </li>
                  <li class="list-group-item d-flex justify-content-between">
                     <span>Total (INR)</span>
                     <strong id="total-amount"></strong>
                  </li>
               </ul>
            </div>

            <!-- billing details -->
            <div class="col-md-7 col-lg-8">
               <h4 class="mb-3">Billing address</h4>
               <form id="checkout-form" class="needs-validation">
                  <div class="row g-3">
                     <div class="col-12">
                        <input type="hidden" id="form-date" name="Date" value="">
                        <label for="name" class="form-label">Name</label>
                        <input type="text" class="form-control" id="name" name="Name" required>
                        <div class="invalid-feedback">
                           Valid first name is required.
                        </div>
                     </div>

                     <div class="col-sm-6">
                        <label for="mob" class="form-label">Mobile No.</label>
                        <input type="tel" class="form-control" name="Mob" id="mob" required>
                     </div>

                     <div class="col-sm-6">
                        <label for="email" class="form-label">Email<span class="text-muted">(Optional)</span></label>
                        <input type="email" class="form-control" id="email" name="Email" value="">
                        <div class="invalid-feedback">
                           Please enter a valid email address for shipping updates.
                        </div>
                     </div>
                     <!-- hidden input | Product info  -->
                     <input type="hidden" name="Product_ID" id="form-prod-id" value="">
                     <input type="hidden" name="Product_Name" id="form-prod-name" value="">
                     <input type="hidden" name="Product_Price" id="form-prod-price" value="">
                     <input type="hidden" name="Discount_Perc" id="form-disc-prec" value="">
                     <input type="hidden" name="Total" id="form-total-amount" value="">

                     <div class="col-12">
                        <label for="address" class="form-label">Address
                           <span class="text-muted">(Line 1)</span>
                        </label>
                        <input type="text" class="form-control" id="address" name="Address_Line1"
                           placeholder="Flat / House No. / Building Name" required>
                        <div class="invalid-feedback">
                           Please enter your shipping address correctly.
                        </div>
                     </div>

                     <div class="col-12">
                        <label for="address2" class="form-label">Address
                           <span class="text-muted">(Line 2)</span>
                        </label>
                        <input type="text" class="form-control" id="address2" name="Address_Line2"
                           placeholder="Street / Colony" value="">
                        <div class="invalid-feedback">
                           Please enter your shipping address correctly.
                        </div>
                     </div>

                     <div class="col-12">
                        <label for="landmark" class="form-label">Landmark
                           <span class="text-muted">(optional)</span>
                        </label>
                        <input type="text" class="form-control" id="landmark" name="Landmark" value="">
                        <div class="invalid-feedback">
                           Please enter the landmark correctly.
                        </div>
                     </div>

                     <div class="col-md-4">
                        <label for="country" class="form-label">Country</label>
                        <select class="form-select" id="country" required name="Country">
                           <option value="India">India</option>
                        </select>
                        <div class="invalid-feedback">
                           Please select a valid country.
                        </div>
                     </div>

                     <div class="col-md-4">
                        <label for="state" class="form-label">State/UT</label>
                        <select class="form-select" id="state" name="State" placeholder="Select" required>
                           <option value="" selected disabled>Select</option>
                           <option value="Andhra_Pradesh">Andhra Pradesh</option>
                           <option value="Arunachal_Pradesh">Arunachal Pradesh</option>
                           <option value="Assam">Assam</option>
                           <option value="Bihar">Bihar</option>
                           <option value="Chandigarh">Chandigarh</option>
                           <option value="Chhattisgarh">Chhattisgarh</option>
                           <option value="Dadra_and_Nagar_Haveli_and_Daman_and_Diu">Dadra &amp; Nagar Haveli and Daman
                              &amp; Diu</option>
                           <option value="Delhi">Delhi</option>
                           <option value="Goa">Goa</option>
                           <option value="Gujarat">Gujarat</option>
                           <option value="Harayana">Harayana</option>
                           <option value="Himachal_Pradesh">Himachal Pradesh</option>
                           <option value="Jammu_and_Kashmir">Jammu & Kashmir</option>
                           <option value="Jharkhand">Jharkhand</option>
                           <option value="Karnataka">Karnataka</option>
                           <option value="Kerala">Kerala</option>
                           <option value="Ladakh">Ladakh</option>
                           <option value="Madhya_Pradesh">Madhya Pradesh</option>
                           <option value="Maharashtra">Maharashtra</option>
                           <option value="Manipur">Manipur</option>
                           <option value="Meghalaya">Meghalaya</option>
                           <option value="Mizoram">Mizoram</option>
                           <option value="Nagaland">Nagaland</option>
                           <option value="Odisha">Odisha</option>
                           <option value="Puducherry">Puducherry</option>
                           <option value="Punjab">Punjab</option>
                           <option value="Rajasthan">Rajasthan</option>
                           <option value="Sikkim">Sikkim</option>
                           <option value="Tamilnadu">Tamil Nadu</option>
                           <option value="Telangana">Telangana</option>
                           <option value="Tripura">Tripura</option>
                           <option value="Uttar_Pradesh">Uttar Pradesh</option>
                           <option value="Uttarakhand">Uttarakhand</option>
                           <option value="West_Bengal">West Bengal</option>
                        </select>
                        <div class="invalid-feedback">
                           Please provide a valid state.
                        </div>
                     </div>

                     <div class="col-md-4">
                        <label for="pincode" class="form-label">PIN Code</label>
                        <input type="number" class="form-control" id="pincode" name="Pincode"
                           placeholder="6-digit area PIN code" required>
                        <div class="invalid-feedback">
                           PIN code required.
                        </div>
                     </div>
                  </div>

                  <hr class="my-4">

                  <h4 class="mb-3">Payment Methods</h4>

                  <div class="my-3">
                     <div class="form-check">
                        <input id="paytm" name="Payment_Method" value="PayTM" type="radio" class="form-check-input"
                           required>
                        <label class="form-check-label" for="paytm">PayTM</label>
                     </div>
                     <div class="form-check">
                        <input id="phonepe" name="Payment_Method" value="PhonePe" type="radio" class="form-check-input"
                           required>
                        <label class="form-check-label" for="phonepe">PhonePe</label>
                     </div>
                     <div class="form-check">
                        <input id="cod" name="Payment_Method" value="COD" type="radio" class="form-check-input"
                           required>
                        <label class="form-check-label" for="cod">Cash on Delivery</label>
                     </div>
                  </div>

                  <hr class="my-4">

                  <div class="row g-3">
                     <div class="col text-center">
                        <button class="w-50 btn btn-success btn-lg" id="submit-button" type="submit">Place Order</button>
                     </div>
                  </div>
               </form>
            </div>
         </div>
      </div>
   </main>

   <!-- footer -->
   <footer>
      <span class="my-5 pt-5 text-muted text-center text-small">
         <p class="mb-1">Â© 2021 Threadwear</p>
         <ul class="list-inline">
            <li class="list-inline-item"><a href="privacymodal.html" id="launch-privacy-modal">Privacy</a></li>
            <li class="list-inline-item"><a href="termsmodal.html" id="launch-terms-modal">Terms</a></li>
            <li class="list-inline-item"><a href="supportmodal.html" id="launch-support-modal">Support</a></li>
         </ul>
      </span>

      <!-- PRIVACY Modal -->
      <div class="modal fade my-10" id="privacy-modal" tabindex="-1" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
         <div class="modal-dialog modal-xl modal-fullscreen-lg-down modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content"></div>
         </div>
      </div>

      <!-- TERMS Modal -->
      <div class="modal fade my-10" id="terms-modal" tabindex="-1" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
         <div class="modal-dialog modal-xl modal-fullscreen-lg-down modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content"></div>
         </div>
      </div>

      <!-- SUPPORT Modal -->
      <div class="modal fade my-10" id="support-modal" tabindex="-1" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
         <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content"></div>
         </div>
      </div>

      <!-- jquery for footer -->
      <script>
         $('#launch-privacy-modal').on('click', function (e) {
            e.preventDefault();
            $('#privacy-modal').modal('show').find('.modal-content').load($(this).attr('href'));
         });

         $('#launch-terms-modal').on('click', function (e) {
            e.preventDefault();
            $('#terms-modal').modal('show').find('.modal-content').load($(this).attr('href'));
         });
         $('#launch-support-modal').on('click', function (e) {
            e.preventDefault();
            $('#support-modal').modal('show').find('.modal-content').load($(this).attr('href'));
         });
      </script>
   </footer>


   <!-- custom JavaScript -->
   <script>
      var queryString;
      var query = {};
      var pairs;
      var totalAmt;

      $(window).on('load', function () {
         parseQuery();
      });

      $(document).ready(function () {

         fillCartDetails(); // to fill cart details

         $('#checkout-form').submit(function (e) {
            e.preventDefault();

            $('#submit-button').attr('disabled','true');
            $('#submit-button').css("cursor","not-allowed");
            $('#submit-button').html(`Placing order&nbsp;&nbsp;<span class="spinner-border" role="status">
               <span class="visually-hidden">Loading...</span></span>`);

            fillHiddenInputs(); //filling hidden inputs
            var $form = $(this);

            // check if the input is valid using a 'valid' property
            // if (!$form.valid) return false;

            // console.log('calling ajax....');
            $.ajax({

               url: 'https://api.apispreadsheets.com/data/13943/',
               type: 'post',
               data: $("#checkout-form").serializeArray(),

               success: function () {
                  window.location.replace('success.html');
               },
               error: function () {
                  window.location.replace('fail.html');
               }

            });

         });

      });

      function parseQuery() {
         queryString = window.location.search;
         pairs = (queryString[0] === '?' ? queryString.substr(1) : queryString).split('&');
         for (var i = 0; i < pairs.length; i++) {
            var pair = pairs[i].split('=');
            query[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1] || '');
         }
      }

      function fillCartDetails() {
         // var res = str.replace(/microsoft/i, "W3Schools");
         if ((typeof query.pDesc) != 'undefined') {
            document.getElementById("product-name").innerHTML = query.pName.replace(/_/g, " ");
            document.getElementById("product-description").innerHTML = query.pDesc.replace(/_/g, " ");
            document.getElementById("product-id").innerHTML = "#".concat(query.pID);
            document.getElementById("product-price").innerHTML = query.pPrice;
            document.getElementById("discount-percentage").innerHTML = (query.discPerc).concat("%");

            var price = parseInt(query.pPrice);
            var discountPer = parseInt(query.discPerc);

            var discountAmt = (price * discountPer) / 100;
            totalAmt = price - discountAmt;
            document.getElementById("discount-amount").innerHTML = "-Rs.".concat(String(discountAmt));
            document.getElementById("total-amount").innerHTML = "Rs.".concat(String(totalAmt));
         }
      }

      function fillHiddenInputs() {
         document.getElementById("form-prod-id").value = query.pID;
         document.getElementById("form-prod-name").value = query.pName;
         document.getElementById("form-prod-price").value = query.pPrice;
         document.getElementById("form-disc-prec").value = query.discPerc;
         document.getElementById("form-total-amount").value = totalAmt;
         document.getElementById("form-date").value = new Date();
      }
   </script>

   <!-- Option 1: Bootstrap Bundle with Popper -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"></script>

</body>

</html>